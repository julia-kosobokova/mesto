!function(){"use strict";class e{constructor(e,t,s,n){this._caption=e,this._image=t,this._templateSelector=s,this._handleCardClick=n}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_handleLikeClick(){this._buttonLike.classList.toggle("element__like_active")}_handleTrashClick(){this._elementClone.remove(),this._elementClone=null}generateCard(){return this._elementClone=this._getTemplate(),this._buttonLike=this._elementClone.querySelector(".element__like"),this._buttonTrash=this._elementClone.querySelector(".element__trash"),this._imageElement=this._elementClone.querySelector(".element__image"),this._captionElement=this._elementClone.querySelector(".element__caption"),this._captionElement.textContent=this._caption,this._imageElement.src=this._image,this._imageElement.alt=this._caption,this._buttonLike.addEventListener("click",(()=>this._handleLikeClick())),this._buttonTrash.addEventListener("click",(()=>this._handleTrashClick())),this._imageElement.addEventListener("click",(()=>this._handleCardClick(this._image,this._caption))),this._elementClone}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s){t(this,"_showInputError",((e,t)=>{const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._options.inputErrorClass),s.textContent=t,s.classList.add(this._options.errorClass)})),t(this,"_hideInputError",(e=>{const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._options.inputErrorClass),t.classList.remove(this._options.errorClass),t.textContent=""})),t(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),t(this,"toggleButtonState",(()=>{this._hasInvalidInput()?this._disableSubmit():this._enableSubmit()})),t(this,"_setEventListeners",(()=>{this._inputList=Array.from(this._formElement.querySelectorAll(this._options.inputSelector)),this._buttonElement=this._formElement.querySelector(this._options.submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))})),t(this,"_hasInvalidInput",(()=>this._inputList.some((e=>!e.validity.valid)))),this._options=e,this._formElement=s}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_disableSubmit(){this._buttonElement.classList.add(this._options.inactiveButtonClass),this._buttonElement.disabled=!0}_enableSubmit(){this._buttonElement.classList.remove(this._options.inactiveButtonClass),this._buttonElement.disabled=!1}enableValidation(){this._setEventListeners()}resetValidation(){this.toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class n{constructor(e){this._popup=document.querySelector(e),this._buttonClose=this._popup.querySelector(".popup__close-button"),this._escEventListener=this._handleEscClose.bind(this),this._overlayEventListener=this._closeOverlay.bind(this),this._closeEventListener=this.close.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._escEventListener)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._escEventListener)}setEventListeners(){this._popup.addEventListener("mousedown",this._overlayEventListener),this._buttonClose.addEventListener("click",this._closeEventListener)}_handleEscClose(e){"Escape"===e.key&&this.close()}_closeOverlay(e){e.target===this._popup&&this.close(e.target)}}class i extends n{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{this._handleFormSubmit(this._getInputValues()),e.preventDefault()}))}close(){super.close(),this._form.reset()}}const o={formSelector:".form",fieldsetSelector:".popup__form-set",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},r=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),p=document.querySelector(".popup_profile"),a=document.querySelector(".popup_element"),c=p.querySelector(".popup__input_type_name"),_=p.querySelector(".popup__input_type_description"),u=p.querySelector(".popup__form"),h=a.querySelector(".popup__form"),d=new s(o,u),m=new s(o,h);d.enableValidation(),m.enableValidation();const v=new i(".popup_profile",(function(e){f.setUserInfo(e),v.close()})),E=new i(".popup_element",(function(e){const t=S(e.name,e.link);L.addItem(t),E.close()})),y=new class extends n{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._text=this._popup.querySelector(".popup__text")}open(e,t){super.open(),this._image.src=e,this._image.alt=t,this._text.textContent=t}}(".popup_image");v.setEventListeners(),E.setEventListeners(),y.setEventListeners();const f=new class{constructor(e){let{nameSelector:t,descriptionSelector:s}=e;this._nameProfile=document.querySelector(t),this._descriptionProfile=document.querySelector(s)}getUserInfo(){const e={};return e.name=this._nameProfile.textContent,e.description=this._descriptionProfile.textContent,e}setUserInfo(e){this._nameProfile.textContent=e.name,this._descriptionProfile.textContent=e.description}}({nameSelector:".profile__name",descriptionSelector:".profile__description"});function S(t,s){return new e(t,s,"#element-template",b).generateCard()}r.addEventListener("click",(()=>function(){const e=f.getUserInfo();c.value=e.name,_.value=e.description,d.resetValidation(),v.open()}())),l.addEventListener("click",(()=>(E.open(),void m.resetValidation())));const L=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._elements=document.querySelector(t)}generate(){this._items.forEach((e=>{const t=this._renderer(e.name,e.link);this.addItem(t)}))}addItem(e){this._elements.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:(e,t)=>S(e,t)},".elements__list");function b(e,t){y.open(e,t)}L.generate()}();